trigger:
- develop
- master
- release/*
- hotfix/*

pr:
- develop
- release/*
- hotfix/*

jobs:
# Build
- job: Build
  pool:
    vmImage: 'windows-2022'
  steps:
  # .NET 5 required for GitVersion
  - task: UseDotNet@2
    inputs:
      version: '5.x'
    displayName: 'Install .NET 5'
  - task: UseDotNet@2
    inputs:
      version: '8.x'
    displayName: 'Install .NET 8'
  - task: UseDotNet@2
    inputs:
      version: '9.x'
    displayName: 'Install .NET 9'
  - powershell: ./build.ps1
    displayName: 'Build'
  - publish: $(Build.SourcesDirectory)/BuildArtifacts/Packages/NuGet
    artifact: NuGet Package
    displayName: 'Publish NuGet package as build artifact'
# Integration Tests Frosting Windows 2019 (.NET 8)
- template: .azuredevops/pipelines/templates/jobs/test-frosting.yml
  parameters:
    vmImage: 'windows-2019'
    dotNetVersion: 8
# Integration Tests Frosting Windows 2019 (.NET 9)
- template: .azuredevops/pipelines/templates/jobs/test-frosting.yml
  parameters:
    vmImage: 'windows-2022'
    dotNetVersion: 9
# Integration Tests Script Runner Windows 2019 (.NET 8)
- template: .azuredevops/pipelines/templates/jobs/test-scripting.yml
  parameters:
    vmImage: 'windows-2019'
    dotNetVersion: 8
# Integration Tests Script Runner Windows 2022 (.NET 9)
- template: .azuredevops/pipelines/templates/jobs/test-scripting.yml
  parameters:
    vmImage: 'windows-2022'
    dotNetVersion: 9
# Integration Tests Frosting macOS 13 (.NET 8)
- template: .azuredevops/pipelines/templates/jobs/test-frosting.yml
  parameters:
    vmImage: 'macOS-13'
    dotNetVersion: 8
# Integration Tests Frosting macOS 14 (.NET 9)
- template: .azuredevops/pipelines/templates/jobs/test-frosting.yml
  parameters:
    vmImage: 'macOS-14'
    dotNetVersion: 9
# Integration Tests Script Runner macOS 13 (.NET 8)
- template: .azuredevops/pipelines/templates/jobs/test-scripting.yml
  parameters:
    vmImage: 'macOS-13'
    dotNetVersion: 8
# Integration Tests Script Runner macOS 14 (.NET 9)
- template: .azuredevops/pipelines/templates/jobs/test-scripting.yml
  parameters:
    vmImage: 'macOS-14'
    dotNetVersion: 9
# Integration Tests Frosting Ubuntu 22.04 (.NET 8)
- template: .azuredevops/pipelines/templates/jobs/test-frosting.yml
  parameters:
    vmImage: 'ubuntu-22.04'
    dotNetVersion: 8
# Integration Tests Frosting Ubuntu 24.04 (.NET 9)
- template: .azuredevops/pipelines/templates/jobs/test-frosting.yml
  parameters:
    vmImage: 'ubuntu-24.04'
    dotNetVersion: 9
# Integration Tests Script Runner Ubuntu 22.04 (.NET tool)
- template: .azuredevops/pipelines/templates/jobs/test-scripting.yml
  parameters:
    vmImage: 'ubuntu-22.04'
    dotNetVersion: 8
# Integration Tests Script Runner Ubuntu 24.04 (.NET tool)
- template: .azuredevops/pipelines/templates/jobs/test-scripting.yml
  parameters:
    vmImage: 'ubuntu-24.04'
    dotNetVersion: 9
